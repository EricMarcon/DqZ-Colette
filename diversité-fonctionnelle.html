<!DOCTYPE html>
<html lang="fr-FR" xml:lang="fr-FR">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 Diversité fonctionnelle | Diversité des pixels</title>
  <meta name="description" content="2 Diversité fonctionnelle | Diversité des pixels" />
  <meta name="generator" content="bookdown 0.26 and GitBook 2.6.7" />

  <meta property="og:title" content="2 Diversité fonctionnelle | Diversité des pixels" />
  <meta property="og:type" content="book" />
  
  
  <meta name="github-repo" content="EricMarcon/DqZ-Colette" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 Diversité fonctionnelle | Diversité des pixels" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="thérorie-de-la-diversité-neutre.html"/>
<link rel="next" href="application-à-une-image.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="thérorie-de-la-diversité-neutre.html"><a href="thérorie-de-la-diversité-neutre.html"><i class="fa fa-check"></i><b>1</b> Thérorie de la diversité neutre</a>
<ul>
<li class="chapter" data-level="1.1" data-path="thérorie-de-la-diversité-neutre.html"><a href="thérorie-de-la-diversité-neutre.html#entropie-de-shannon"><i class="fa fa-check"></i><b>1.1</b> Entropie de Shannon</a></li>
<li class="chapter" data-level="1.2" data-path="thérorie-de-la-diversité-neutre.html"><a href="thérorie-de-la-diversité-neutre.html#entropie-généralisée"><i class="fa fa-check"></i><b>1.2</b> Entropie généralisée</a></li>
<li class="chapter" data-level="1.3" data-path="thérorie-de-la-diversité-neutre.html"><a href="thérorie-de-la-diversité-neutre.html#nombres-de-hill"><i class="fa fa-check"></i><b>1.3</b> Nombres de Hill</a></li>
<li class="chapter" data-level="1.4" data-path="thérorie-de-la-diversité-neutre.html"><a href="thérorie-de-la-diversité-neutre.html#profils-de-diversité"><i class="fa fa-check"></i><b>1.4</b> Profils de diversité</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="diversité-fonctionnelle.html"><a href="diversité-fonctionnelle.html"><i class="fa fa-check"></i><b>2</b> Diversité fonctionnelle</a></li>
<li class="chapter" data-level="3" data-path="application-à-une-image.html"><a href="application-à-une-image.html"><i class="fa fa-check"></i><b>3</b> Application à une image</a></li>
<li class="chapter" data-level="4" data-path="cours-complet.html"><a href="cours-complet.html"><i class="fa fa-check"></i><b>4</b> Cours complet</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Diversité des pixels</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="diversité-fonctionnelle" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> Diversité fonctionnelle<a href="diversité-fonctionnelle.html#diversité-fonctionnelle" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>La diversité définie précédemment est dite <em>neutre</em> parce que les différences entre espèces sont les mêmes.
L’identité des espèces n’a pas d’importance: deux individus sont de la même espèce ou d’espèces différentes, mais cette différence ne varie pas.</p>
<p>La définition de la rareté peut être généralisée pour prendre en compte la proximité plus ou moins grande des espèces <span class="citation">(Leinster et Cobbold 2012)</span>.</p>
<p>On définit une distance entre toutes les paires d’individus (qui peut ne dépendre que de leurs espèces ou varier pour chaque individu).
De façon équivalente, on peut écrire une matrice de distance ou placer les individus dans un espace multidimensionnel (la transformation est une Analyse en Coordonnées Principales: PcoA).
On obtient ce type de données en calculant les distances entre individus en partir de leurs valeurs de traits fonctionnels (d’où le nom de diversité fonctionnelle) ou de n’importe quelle valeurs numériques multidimensionnelles (comme la distance entre pixels d’une image dans l’espace colorimétrique).</p>
<p>Les distances doivent être transformée en similarités.
Classiquement:</p>
<ul>
<li>on normalise les distances entre 0 et 1 et on définit la similarité comme 1 moins la distance.</li>
<li>ou (les propriétés mathématiques sont plus solides), on définit la similarité comme l’exponentielle négative de la distance.
La similarité entre les espèces <span class="math inline">\(s\)</span> et <span class="math inline">\(t\)</span> est <span class="math inline">\(z_{s,t}=e^{-u d_{s,t}}\)</span> où <span class="math inline">\(u\)</span> est un réel positif qui fixe la décroissance de la similarité en fonction de la distance: plus <span class="math inline">\(u\)</span> est grand, plus les espèces sont dissimilaires pour une même distance.</li>
</ul>
<p>Un individu est complètement similaire à lui-même (distance nulle, similarité égale à 1).</p>
<blockquote>
<p>Exemple: les distances entre les 3 espèces sont dans la matrice:</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="diversité-fonctionnelle.html#cb32-1" aria-hidden="true" tabindex="-1"></a>D <span class="ot">&lt;-</span> <span class="fu">matrix</span>(</span>
<span id="cb32-2"><a href="diversité-fonctionnelle.html#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(</span>
<span id="cb32-3"><a href="diversité-fonctionnelle.html#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">5</span>,</span>
<span id="cb32-4"><a href="diversité-fonctionnelle.html#cb32-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">5</span>, </span>
<span id="cb32-5"><a href="diversité-fonctionnelle.html#cb32-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">5</span>, <span class="dv">5</span>, <span class="dv">0</span></span>
<span id="cb32-6"><a href="diversité-fonctionnelle.html#cb32-6" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb32-7"><a href="diversité-fonctionnelle.html#cb32-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>)</span>
<span id="cb32-8"><a href="diversité-fonctionnelle.html#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(D) <span class="ot">&lt;-</span> <span class="fu">rownames</span>(D) <span class="ot">&lt;-</span> <span class="fu">names</span>(C)</span></code></pre></div>
<p></p>
<blockquote>
<p>Dans l’espace engendré par cette matrice de distance :</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="diversité-fonctionnelle.html#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&quot;ade4&quot;</span>)</span>
<span id="cb33-2"><a href="diversité-fonctionnelle.html#cb33-2" aria-hidden="true" tabindex="-1"></a>D <span class="sc">%&gt;%</span></span>
<span id="cb33-3"><a href="diversité-fonctionnelle.html#cb33-3" aria-hidden="true" tabindex="-1"></a>    as.dist <span class="sc">%&gt;%</span></span>
<span id="cb33-4"><a href="diversité-fonctionnelle.html#cb33-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dudi.pco</span>(<span class="at">scannf =</span> <span class="cn">FALSE</span>, <span class="at">nf =</span> <span class="dv">2</span>) <span class="sc">%&gt;%</span></span>
<span id="cb33-5"><a href="diversité-fonctionnelle.html#cb33-5" aria-hidden="true" tabindex="-1"></a>    scatter</span></code></pre></div>
<p><img src="DqZ_files/figure-html/unnamed-chunk-6-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p></p>
<blockquote>
<p>La matrice de similarité est obtenue en prenant l’exponentielle négative de la similarité, avec <span class="math inline">\(u=1\)</span> pour commencer.</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="diversité-fonctionnelle.html#cb34-1" aria-hidden="true" tabindex="-1"></a>(Z <span class="ot">&lt;-</span> <span class="fu">exp</span>(<span class="sc">-</span>D))</span></code></pre></div>
<pre><code>##             s1          s2          s3
## s1 1.000000000 0.367879441 0.006737947
## s2 0.367879441 1.000000000 0.006737947
## s3 0.006737947 0.006737947 1.000000000</code></pre>
<p></p>
<p>La <em>banalité</em> d’un individu est sa similarité moyenne avec tous les autres, y compris lui-même.</p>
<blockquote>
<p>La banalité des individus est la même à l’intérieur de chacune des trois espèces: on parle de banalité des espèces.
Elle vaut:</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="diversité-fonctionnelle.html#cb36-1" aria-hidden="true" tabindex="-1"></a>(B <span class="ot">&lt;-</span> Z <span class="sc">%*%</span> C)</span></code></pre></div>
<pre><code>##         [,1]
## s1 0.5936543
## s2 0.4356242
## s3 0.2550535</code></pre>
<p></p>
<p>Dans le cadre de la diversité neutre vue précédemment, tous les arbres d’une même espèce ont une similarité de 1, et tous les arbres d’espèces différentes ont une similarité nulle (la distance entre individus d’espèces différentes est infinie).
Dans ce cas particulier, la banalité des arbres d’une espèce est la probabilité de l’espèce.</p>
<p>Dans le cas plus général d’individus regroupés en espèces placées dans un espace multidimensionnel, leur banalité est supérieure à leur probabilité: un individu est d’autant plus banal qu’il existe des individus proches de lui.
Dans une approche d’écologie fonctionnelle, la diversité est celle de l’occupation des niches.
La niche occupée principalement par un individu l’est aussi un peu par les individus proches fonctionnellement.</p>
<p>La <em>rareté</em> est définie comme l’inverse de la banalité, l’entropie est la moyenne du logarithme de la rareté et la diversité est son exponentielle: la théorie est identique à celle de la diversité neutre.</p>
<blockquote>
<p>La rareté des espèces est</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="diversité-fonctionnelle.html#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>B</span></code></pre></div>
<pre><code>##        [,1]
## s1 1.684482
## s2 2.295557
## s3 3.920747</code></pre>
<p></p>
<blockquote>
<p>à comparer avec l’inverse des probabilités</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="diversité-fonctionnelle.html#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span><span class="sc">/</span>C <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="diversité-fonctionnelle.html#cb40-2" aria-hidden="true" tabindex="-1"></a>    as.matrix</span></code></pre></div>
<pre><code>##    [,1]
## s1    2
## s2    4
## s3    4</code></pre>
<p></p>
<blockquote>
<p>Les espèces sont moins rares parce que chacune est “complétée” par les effectifs des espèces proches.</p>
</blockquote>
<blockquote>
<p>Le nouveau profil des diversité est le suivant:</p>
</blockquote>
<p></p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="diversité-fonctionnelle.html#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CommunityProfile</span>(Dqz, <span class="at">NorP =</span> C, <span class="at">Z =</span> Z) <span class="sc">%&gt;%</span></span>
<span id="cb42-2"><a href="diversité-fonctionnelle.html#cb42-2" aria-hidden="true" tabindex="-1"></a>    autoplot</span></code></pre></div>
<p><img src="DqZ_files/figure-html/unnamed-chunk-11-1.png" width="80%" style="display: block; margin: auto;" /></p>
<p></p>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="thérorie-de-la-diversité-neutre.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="application-à-une-image.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
